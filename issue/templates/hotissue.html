{% extends 'base.html' %}
{% load staticfiles %}
{% block title %}노룩뉴스{% endblock %}
{% block extra_head_content %}
{{ block.super }}
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
td.issueRank {
    width: 32px;
    font-size: 150%;
    color: yellow;
}
td.issueSubject {
    font-size: 130%;
}
td.issueDown {
    font-size: 75%;
}

span.issueshowall {
    background-color: #8298a6;
    font-size: 80%;
}

a:link {color:white; text-decoration:none;}
a:visited {color:white; text-decoration:none;}
a:hover {color:yellow; text-decoration:none;}
</style>
<script>
function search() {
    var type = document.getElementById('searchType').value;
    var word = document.getElementById('searchWord').value;
    if (!word) {
        alert("검색어를 입력하세요.");
        return;
    }
    var url = "{% url 'search issue' searchType='type' searchWord='word' %}".replace(/type/, type).replace(/word/, word).replace(/http:\/\//, '').replace(/https:\/\//, '').replace(/twitter.com\//, '').replace(/facebook.com\//, '');
    if (url.substr(-1) == '/') {
        url = url.slice(0, -1);
    }
    location.href = url;
}

function onKeyPress(e) {
    if (e.keyCode == 13) {
        e.preventDefault();
        search();
    }
}
</script>
{% endblock %}
{% block content %}
<table class="headMenu">
<tr>
    <td class="menuHotIssue"><a href="{% url 'show issues' %}">노룩뉴스</a></td>
    <td class="menuRanking"><a href="{% url 'ranking' %}">랭킹</a></td>
    <td class="menuGizaDB"><a href="{% url 'show giza' %}">기자 지구</a></td>
    <td class="headMenu">
    {% if user.is_authenticated %}
    <a href="{% url 'new issue' %}"><img src="{% static 'icons/add24.png' %}" title="이슈 생성"></a> <a href="{% url 'logout' %}?next={% url 'show issues' %}"><img src="{% static 'icons/unidentity24.png' %}" title="로그아웃"></a>
    {% else %}
    <a href="{% url 'login' %}?next={% url 'show issues' %}"><img src="{% static 'icons/identity24.png' %}" title="로그인"></a>
    {% endif %}&nbsp;
    </td>
</tr>
</table>
<div class="dbSearch">
    <select id="searchType">
        <option value="belongto">언론사</option>
        <option value="name">기자 이름</option>
        <option value="email">기자 이메일</option>
        <option value="subject">기사 제목</option>
        <option value="url">기자 URL</option>
    </select>
    <input type="text" id="searchWord" class="searchWord" maxlength="254" onkeypress="onKeyPress(event)"> <input type="button" id="searchButton" value="검색" class="searchButton" onClick="search()"> <span class="issueshowall"><a href="{% url 'show recent issues' %}">최근 100개 보기</a></span> {% if user.is_superuser %}<span class="issueshowall"><a href="{% url 'show all issues' %}">모두 보기</a></span>{% endif %}
</div>
<div class="annotation">
일주일 동안 가장 많이 '찍힌'' 뉴스의 순위입니다.
</div>

<div class="issue">
{% for issue in issues %}
    <table class="issue">
    <tr>
        <td rowspan="2" class="issueRank">{{forloop.counter}}</td>
        <td class="issueSubject"><a href="{{issue.url}}" target="_blank">{{issue.subject}}</a> {% if issue.archive %}<a href="{{issue.archive}}" target="_blank"><img src="{% static 'icons/unarchive18.png' %}"></a>{% endif %}</td>
        {% if user.is_authenticated %}
        <td rowspan="2" width="32px"><a href="{% url 'edit issue' id=issue.id %}"><img src="{% static 'icons/edit24.png' %}" title="편집"></a></td>
        {% endif %}
    </tr>
    <tr>
        <td class="issueDown"><a href="{% url 'search giza' searchType='email' searchWord=issue.email %}">{{issue.email}}</a> ({{issue.count}}번 찍힘)</td>
    </tr>
    </table>
    {% if not forloop.last %}
        <hr>
    {% endif %}
{% endfor %}
</div>

<div class="footer">
<strike>게시판</strike> | <a href={{ABOUT_LINK}} target="_blank">노룩뉴스 소개</a> | 문의사항, 의견 보내기: <font color="black"><a href="mailto:gencode.me@gmail.com">gencode.me@gmail.com</a></font>
</div>
{% endblock %}
