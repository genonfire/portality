{% extends 'base.html' %}
{% load staticfiles %}
{% load tags %}
{% block title %}노룩뉴스{% endblock %}
{% block extra_head_content %}
{{ block.super }}
<script>
function search(searchRange, nolook) {
    var type = document.getElementById('searchType').value;
    var word = document.getElementById('searchWord').value.replace(/\s+$/, '');
    if (!word) {
        alert("검색어를 입력하세요.");
        return;
    }
    var url = "{% url 'search issue' searchRange='searchRange' searchType='type' searchWord='word' nolook='nolook' %}".replace(/searchRange/, searchRange).replace(/type/, type).replace(/word/, word).replace(/nolook/, nolook).replace(/http:\/\//, '').replace(/https:\/\//, '').replace(/twitter.com\//, '').replace(/facebook.com\//, '');
    if (url.substr(-1) == '/') {
        url = url.slice(0, -1);
    }
    location.href = url;
}

function onKeyPress(e, searchRange, nolook) {
    if (e.keyCode == 13) {
        e.preventDefault();
        search(searchRange, nolook);
    }
}
</script>
{% endblock %}
{% block content %}
<div id="wrap">
    <div id="header">
        <div class="gnb">
            <ul>
                <li><a href="{% url 'show today' %}">노룩뉴스</a></li>
                <li><a href="{% url 'show issues' %}">베스트</a></li>
                <li><a href="{% url 'ranking' %}">랭킹</a></li>
                <li><a href="{% url 'show giza' %}">기자지구</a></li>
            </ul>
        </div>
        {% if user.is_authenticated and nolook != 'all' and today == True %}
        <div class="util utilDuo">
        <a href="{% url 'new issue' nolook=nolook %}"><img src="{% static 'icons/add24.png' %}" title="이슈 생성"></a> <a href="{% url 'login' %}"><img src="{% static 'icons/face24.png' %}" title="회원정보"></a>
        {% else %}
        <div class="util utilSolo">
        <a href="{% url 'login' %}">{% if user.is_authenticated %}<img src="{% static 'icons/face24.png' %}" title="회원정보">{% else %}<img src="{% static 'icons/identity24.png' %}" title="로그인">{% endif %}</a>
        {% endif %}
        </div>
    </div>

<div id="contents">
{% if nolook != 'all' %}
{% if today == True %}
<h1>노룩뉴스</h1>
{% else %}
<h1>노룩 베스트</h1>
{% endif %}
<div class="annotation">
{% if nolook == 'nolook' %}
{% if today == True %}<font color="#e02d31">'나빠요!'</font>를 받은 오늘의 뉴스 순위입니다.<span><a href="{% url 'show today+' nolook='look' %}">좋아요! 순위 보기</a></span>
{% else %}<font color="#e02d31">'나빠요!'</font>를 많이 받은 뉴스가 자동 등록됩니다.<span><a href="{% url 'show good issues' nolook='look' %}">좋아요! 보기</a></span>
{% endif %}
{% else %} <!-- // look -->
{% if today == True %}<font color="#1e88e5">'좋아요!'</font>를 받은 오늘의 뉴스 순위입니다.<span><a href="{% url 'show today' %}">나빠요! 순위 보기</a></span>
{% else %}<font color="#1e88e5">'좋아요!'</font>를 많이 받은 뉴스가 자동 등록됩니다.<span><a href="{% url 'show issues' %}">나빠요! 보기</a></span>
{% endif %}
{% endif %}
</div>
{% endif %} <!-- //not all -->

{% if nolook == 'all' %}
<div class="annotation">
'나빠요!'를 받은 기사
</div>
<div class="issue">
{% for issue in nolookissues %}
    <table class="issue">
    <tr>
        <td rowspan="2" class="issueRank" align="center">{{forloop.counter}}</td>
        <td class="issueSubject"><a href="{{issue.url}}" target="_blank">{{issue.subject}}</a> {% if issue.archive %}<a href="{{issue.archive}}" target="_blank" class="archive"><img src="{% static 'icons/unarchive18.png' %}"></a>{% endif %}</td>
        {% if user.is_authenticated %}
        <td rowspan="2" width="32px" class="editIssue"><a href="{% url 'edit issue' id=issue.id %}" class="editIcon"><img src="{% static 'icons/edit24.png' %}" title="편집"></a></td>
        {% endif %}
    </tr>
    <tr>
        <td class="issueDown"><a href="{% url 'search giza' searchType='email' searchWord=issue.email %}" title="기자 정보">{{issue.email}}</a> (나빠요! {{issue.count}}번) <span class="thumb"><a href="{% url 'thumb down' id=issue.id %}"><img src="{% static 'icons/thumb_down14.png' %}" title="나빠요!"></a> <a href="{% url 'thumb up' id=issue.id %}"><img src="{% static 'icons/thumb_up14.png' %}" title="좋아요!"></a></span></td>
    </tr>
    </table>
    {% if not forloop.last %}
        <hr>
    {% endif %}
{% endfor %}
</div>
<div class="goodIssue">
<div class="annotation">
'좋아요!'를 받은 기사
</div>
{% for issue in lookissues %}
    <table class="goodIssue">
    <tr>
        <td rowspan="2" class="issueRank" align="center">{{forloop.counter}}</td>
        <td class="issueSubject"><a href="{{issue.url}}" target="_blank">{{issue.subject}}</a> {% if issue.archive %}<a href="{{issue.archive}}" target="_blank" class="archive"><img src="{% static 'icons/unarchive18.png' %}"></a>{% endif %}</td>
        {% if user.is_authenticated %}
        <td rowspan="2" width="32px" class="editIssue"><a href="{% url 'edit issue' id=issue.id %}" class="editIcon"><img src="{% static 'icons/edit24.png' %}" title="편집"></a></td>
        {% endif %}
    </tr>
    <tr>
        <td class="issueDown"><a href="{% url 'search giza' searchType='email' searchWord=issue.email %}" title="기자 정보">{{issue.email}}</a> (좋아요! {{issue.goodcount}}번) <span class="thumb"><a href="{% url 'thumb down' id=issue.id %}"><img src="{% static 'icons/thumb_down14.png' %}" title="나빠요!"></a> <a href="{% url 'thumb up' id=issue.id %}"><img src="{% static 'icons/thumb_up14.png' %}" title="좋아요!"></a></span></td>
    </tr>
    </table>
    {% if not forloop.last %}
        <hr>
    {% endif %}
{% endfor %}
</div>

{% else %} <!-- //show issues -->
{% if nolook == 'nolook' %}
<div class="issue">
{% else %}
<div class="goodIssue">
{% endif %}
{% for issue in issues %}
    {% if nolook == 'nolook' %}
    <table class="issue">
    {% else %}
    <table class="goodIssue">
    {% endif %}
    <tr>
        <td rowspan="2" class="issueRank" align="center">
        {% if not index %}{{forloop.counter}}{% else %}{% getIndex forloop.counter index %}{% endif %}</td>
        <td class="issueSubject"><a href="{{issue.url}}" target="_blank">{{issue.subject}}</a> {% if issue.archive %}<a href="{{issue.archive}}" target="_blank" class="archive"><img src="{% static 'icons/unarchive18.png' %}"></a>{% endif %}</td>
        {% if user.is_authenticated %}
        <td rowspan="2" width="32px" class="editIssue"><a href="{% url 'edit issue' id=issue.id %}" class="editIcon"><img src="{% static 'icons/edit24.png' %}" title="편집"></a></td>
        {% endif %}
    </tr>
    <tr>
        <td class="issueDown"><a href="{% url 'search giza' searchType='email' searchWord=issue.email %}" title="기자 정보">{{issue.email}}</a> ({% if nolook == 'nolook' %}나빠요! {{issue.count}}{% else %}좋아요! {{issue.goodcount}}{% endif %}번) <span class="thumb"><a href="{% url 'thumb down' id=issue.id %}"><img src="{% static 'icons/thumb_down14.png' %}" title="나빠요!"></a> <a href="{% url 'thumb up' id=issue.id %}"><img src="{% static 'icons/thumb_up14.png' %}" title="좋아요!"></a></span></td>
    </tr>
    </table>
    {% if not forloop.last %}
        <hr>
    {% endif %}
{% endfor %}
</div>

{% if total %}
<div class="dbSearch align-center">
총 {{ total }}개의 뉴스가 있습니다.
{% if prevPage %}<span><a href="{% url 'show best issues' page=prevPage nolook=nolook %}">이전</a></span>{% endif %}
{% if nextPage %}<span><a href="{% url 'show best issues' page=nextPage nolook=nolook %}">다음</a></span>{% endif %}
</div>
{% endif %}
<div class="dbSearch align-center">
    <select id="searchType">
        <option value="belongto">언론사</option>
        <option value="name">기자 이름</option>
        <option value="email">기자 이메일</option>
        <option value="subject">기사 제목</option>
        <option value="url">기자 URL</option>
    </select>
    <input type="text" id="searchWord" class="searchWord" maxlength="254" onkeypress="onKeyPress(event, '{{searchRange}}', '{{nolook}}')">
    <input type="button" id="searchButton" value="검색" class="searchButton" onClick="search('{{searchRange}}', '{{nolook}}')">
    {% if today %}
    <span><a href="{% url 'show today all' nolook=nolook %}">모두 보기</a></span>
    {% endif %}
</div>
{% endif %} <!-- //all -->

{% if not DEBUG %}
<div class="sense">
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- nolooknews-bottom -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-6024742495031342"
     data-ad-slot="8980979712"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
{% endif %}

</div> <!-- //Contents -->

<div id="footer">
    <div class="footerMenu">
        <ul>
            <li><strike>게시판</strike></li>
            <li><a href={{ABOUT_LINK}}>노룩뉴스 소개</a></li>
            <li>테마 디자인 : {{THEME_DESIGNER}}</a></li>
            <li>문의, 의견 보내기 : <a href="mailto:gencode.me@gmail.com">gencode.me@gmail.com</a></li>
            <li><a href="https://twitter.com/nolooknews" target="_blank"><img src="{% static 'icons/twitter24.png' %}"</a></li>
        </ul>
    </div>
</div>

</div> <!-- //wrap -->
{% endblock %}
